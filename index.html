<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Crypto Portfolio Tracker</title>
  <meta name="description" content="Single-page crypto portfolio tracker showing Binance (USD) and WazirX (INR) prices and totals.">
  <style>
    :root { color-scheme: light dark; --bg:#0b0c0f; --fg:#e8e9ee; --card:#151821; --muted:#98a2b3; --accent:#3b82f6; --border:#212635; }
    * { box-sizing:border-box }
    body { margin:0; font-family: Inter, ui-sans-serif, system-ui, Segoe UI, Roboto, Arial; background:var(--bg); color:var(--fg); }
    header { padding:16px; border-bottom:1px solid var(--border); position:sticky; top:0; backdrop-filter:saturate(160%) blur(6px); background: color-mix(in oklab, var(--bg) 85%, transparent); }
    h1 { margin:0; font-size:18px; }
    .container { max-width: 980px; margin: 0 auto; padding: 16px; }
    .toolbar { display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-top:8px; }
    button { background:#1b2030; color:var(--fg); border:1px solid var(--border); border-radius:8px; padding:8px 12px; font-size:14px; cursor:pointer; }
    button.primary { background: var(--accent); border-color: var(--accent); color:white; }
    .cards { display:grid; grid-template-columns:repeat(auto-fit, minmax(260px,1fr)); gap:12px; margin-top:12px; }
    .card { background:var(--card); border:1px solid var(--border); border-radius:12px; padding:14px 16px; }
    .row { display:flex; align-items:center; justify-content:space-between; margin:6px 0; }
    .label { color:var(--muted); font-size:13px; }
    .value { font-weight:600; }
    .total { font-size:22px; font-weight:800; }
    table { width:100%; border-collapse:collapse; margin-top:12px; }
    th, td { padding:10px 8px; border-bottom:1px solid var(--border); }
    th { text-align:left; color:var(--muted); font-weight:600; }
    td.num, th.num { text-align:right; }
    footer { font-size:12px; color:var(--muted); text-align:center; padding:16px; }
    .asof { margin-left:auto; font-size:12px; color:var(--muted); }
    .pill { font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid var(--border); }
    @media (max-width:520px){ .total { font-size:18px } }
  </style>
</head>
<body>
  <header>
    <div class="container" style="display:flex; gap:12px; align-items:center; flex-wrap:wrap">
      <h1>Crypto Portfolio Tracker</h1>
      <span class="pill">Live</span>
      <div class="toolbar">
        <button id="refresh" class="primary">Refresh</button>
        <button id="auto">Auto: Off</button>
        <span class="asof" id="asof">—</span>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="cards">
      <div class="card">
        <div class="row"><div class="label">Total (USD from Binance)</div><div class="total" id="total_usd">$0.00</div></div>
        <div class="row"><div class="label">Per-asset breakdown below</div><div class="label">BTC 0.000005 · ETH 0.25 · WRX 23</div></div>
      </div>
      <div class="card">
        <div class="row"><div class="label">Total (INR from WazirX)</div><div class="total" id="total_inr">₹0.00</div></div>
        <div class="row"><div class="label">Converted locally, no keys</div><div class="label">Binance + WazirX</div></div>
      </div>
    </div>

    <table>
      <thead>
        <tr>
          <th>Asset</th>
          <th class="num">Qty</th>
          <th class="num">Binance Price (USD)</th>
          <th class="num">Value (USD)</th>
          <th class="num">WazirX Price (INR)</th>
          <th class="num">Value (INR)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>BTC</td>
          <td class="num">0.000005</td>
          <td class="num" id="btc_px_usd">—</td>
          <td class="num" id="btc_val_usd">—</td>
          <td class="num" id="btc_px_inr">—</td>
          <td class="num" id="btc_val_inr">—</td>
        </tr>
        <tr>
          <td>ETH</td>
          <td class="num">0.25</td>
          <td class="num" id="eth_px_usd">—</td>
          <td class="num" id="eth_val_usd">—</td>
          <td class="num" id="eth_px_inr">—</td>
          <td class="num" id="eth_val_inr">—</td>
        </tr>
        <tr>
          <td>WRX</td>
          <td class="num">23</td>
          <td class="num" id="wrx_px_usd">—</td>
          <td class="num" id="wrx_val_usd">—</td>
          <td class="num" id="wrx_px_inr">—</td>
          <td class="num" id="wrx_val_inr">—</td>
        </tr>
      </tbody>
    </table>
  </main>

  <footer>
    Data sources: Binance public price ticker (USD) and WazirX public 24h ticker (INR). No API keys required. Deploy on GitHub Pages by committing this file and enabling Pages in repository settings.
  </footer>

<script>
const qty = { BTC: 0.000005, ETH: 0.25, WRX: 23 };
const nfUSD = new Intl.NumberFormat(undefined, { style:'currency', currency:'USD' });
const nfINR = new Intl.NumberFormat(undefined, { style:'currency', currency:'INR' });

async function j(url){
  const r = await fetch(url, { cache:'no-store' });
  if(!r.ok) throw new Error(`${r.status} ${r.statusText}`);
  return r.json();
}

// Binance USD prices (USDT as USD proxy). Try WRXUSDT; if unavailable, derive from WazirX INR via USDTINR.
async function loadBinanceUSD() {
  const [btc, eth] = await Promise.all([
    j('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT'),
    j('https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT'),
  ]);
  let wrxUSD;
  try {
    const wrx = await j('https://api.binance.com/api/v3/ticker/price?symbol=WRXUSDT');
    wrxUSD = parseFloat(wrx.price);
  } catch {
    const [wrxINR, usdtINR] = await Promise.all([
      j('https://api.wazirx.com/sapi/v1/ticker/24hr?symbol=wrxinr'),
      j('https://api.wazirx.com/sapi/v1/ticker/24hr?symbol=usdtinr'),
    ]);
    wrxUSD = parseFloat(wrxINR.lastPrice) / parseFloat(usdtINR.lastPrice);
  }
  return {
    BTC: parseFloat(btc.price),
    ETH: parseFloat(eth.price),
    WRX: wrxUSD
  };
}

// WazirX INR prices
async function loadWazirXINR() {
  const [btc, eth, wrx] = await Promise.all([
    j('https://api.wazirx.com/sapi/v1/ticker/24hr?symbol=btcinr'),
    j('https://api.wazirx.com/sapi/v1/ticker/24hr?symbol=ethinr'),
    j('https://api.wazirx.com/sapi/v1/ticker/24hr?symbol=wrxinr'),
  ]);
  return {
    BTC: parseFloat(btc.lastPrice),
    ETH: parseFloat(eth.lastPrice),
    WRX: parseFloat(wrx.lastPrice)
  };
}

async function refresh() {
  const asof = document.getElementById('asof');
  asof.textContent = 'Fetching...';
  try {
    const [pxUSD, pxINR] = await Promise.all([loadBinanceUSD(), loadWazirXINR()]);

    // Per-coin values in USD
    const usdVals = {
      BTC: pxUSD.BTC * qty.BTC,
      ETH: pxUSD.ETH * qty.ETH,
      WRX: pxUSD.WRX * qty.WRX
    };
    // Per-coin values in INR
    const inrVals = {
      BTC: pxINR.BTC * qty.BTC,
      ETH: pxINR.ETH * qty.ETH,
      WRX: pxINR.WRX * qty.WRX
    };

    // Update price cells
    document.getElementById('btc_px_usd').textContent = nfUSD.format(pxUSD.BTC);
    document.getElementById('eth_px_usd').textContent = nfUSD.format(pxUSD.ETH);
    document.getElementById('wrx_px_usd').textContent = nfUSD.format(pxUSD.WRX);

    document.getElementById('btc_px_inr').textContent = nfINR.format(pxINR.BTC);
    document.getElementById('eth_px_inr').textContent = nfINR.format(pxINR.ETH);
    document.getElementById('wrx_px_inr').textContent = nfINR.format(pxINR.WRX);

    // Update value cells
    document.getElementById('btc_val_usd').textContent = nfUSD.format(usdVals.BTC);
    document.getElementById('eth_val_usd').textContent = nfUSD.format(usdVals.ETH);
    document.getElementById('wrx_val_usd').textContent = nfUSD.format(usdVals.WRX);

    document.getElementById('btc_val_inr').textContent = nfINR.format(inrVals.BTC);
    document.getElementById('eth_val_inr').textContent = nfINR.format(inrVals.ETH);
    document.getElementById('wrx_val_inr').textContent = nfINR.format(inrVals.WRX);

    // Totals
    const totalUSD = usdVals.BTC + usdVals.ETH + usdVals.WRX;
    const totalINR = inrVals.BTC + inrVals.ETH + inrVals.WRX;

    document.getElementById('total_usd').textContent = nfUSD.format(totalUSD);
    document.getElementById('total_inr').textContent = nfINR.format(totalINR);

    asof.textContent = new Date().toLocaleString();
  } catch (e) {
    asof.textContent = `Error: ${e.message}`;
  }
}

document.getElementById('refresh').addEventListener('click', refresh);
let autoTimer = null;
document.getElementById('auto').addEventListener('click', (e)=>{
  if(autoTimer){
    clearInterval(autoTimer);
    autoTimer = null;
    e.target.textContent = 'Auto: Off';
  } else {
    autoTimer = setInterval(refresh, 15000);
    e.target.textContent = 'Auto: 15s';
    refresh();
  }
});

// Initial load
refresh();
</script>
</body>
</html>
